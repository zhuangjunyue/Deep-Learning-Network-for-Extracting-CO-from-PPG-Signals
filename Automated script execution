import os

folder_path = r"C:\Users\HUAWEI\Desktop\CO\5.1 940nm"
checkpoint_script_path = r"C:\Users\HUAWEI\.ipynb_checkpoints\PPG extract CO-checkpoint.py"
start_file = "2022.05.01__10_54_inf1_940nm.txt"

# 获取并排序文件夹中的所有.txt文件
files = [f for f in os.listdir(folder_path) if f.endswith('.txt')]
files.sort()

# 找到起始文件的索引
start_index = files.index(start_file) if start_file in files else 0

# 从指定的文件开始执行脚本
for file in files[start_index:]:
    file_path = os.path.join(folder_path, file)

    with open(checkpoint_script_path, 'r', encoding='utf-8') as script_file:
        script_content = script_file.read()

    # 将file_path和file作为参数传递给脚本
    exec_globals = {'file_path': file_path, 'file': file}
    exec(script_content, exec_globals)
